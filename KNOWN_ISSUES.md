# Known Issues

## Legend

- **ID**: `{PREFIX}-XXX` format (e.g., `AUTH-001`, `CACHE-002`)
- **Verification**: `unit` | `fake-adapter` | `property` | `concurrency` | `differential` | `parallel-isolation` | `tra`
- **Complexity**: `EASY` (< 30 min) | `MED` (30 min - 2 hours) | `HARD` (> 2 hours)
- **Status**: `unconfirmed` | `confirmed` | `fixed` | `wontfix`
- **Source**: `hex-analysis` | `property-test` | `concurrency-test` | `differential-test` | `unit-test` | `manual` | `roadmap-update` | `roadmap-migration` | `tech-debt`
- **Description**: Brief issue description
- **Location**: File path, function name, or component where issue occurs
- **Timestamp**: ISO 8601 format `YYYY-MM-DD`

## Unconfirmed Issues

| ID         | Verification | Complexity | Status      | Source       | Description                                                                                                                                                          | Location                                                                      | Timestamp  |
| ---------- | ------------ | ---------- | ----------- | ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- | ---------- |

## Confirmed Issues

| ID         | Verification | Complexity | Status    | Source           | Description                                                                                                                                                                                   | Location                                                                          | Timestamp  |
| ---------- | ------------ | ---------- | --------- | ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- | ---------- |
| DJANGO-011 | unit         | MED        | confirmed | tech-debt        | [testing] [blocking] Integration test infrastructure created with placeholder tests. Tests skip gracefully when Docker/FUSE not available. Full implementation requires Docker Compose setup. | `tests/django_adapter/integration/`                                               | 2025-12-18 |

## Resolved Issues

| ID         | Verification | Complexity | Status  | Source           | Description                                                                                                                                                                                                                                  | Location                                                                            | Timestamp  |
| ---------- | ------------ | ---------- | ------- | ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ---------- |
| CORE-003   | unit         | EASY       | fixed   | unit-test        | Settings validation rejects path traversal attacks (e.g., `../../../etc/passwd`). Unit tests implemented.                                                                                                                                    | `litefs/domain/settings.py`                                                         | 2025-12-18 |
| DJANGO-001 | property     | MED        | fixed   | property-test    | Settings reader round-trip conversion is idempotent. Property-based test implemented.                                                                                                                                                        | `litefs_django/settings.py`                                                         | 2025-12-18 |
| DJANGO-002 | unit         | EASY       | fixed   | unit-test        | Settings reader case sensitivity mapping (UPPER_CASE → snake_case) works correctly. Unit tests implemented.                                                                                                                                  | `litefs_django/settings.py`                                                         | 2025-12-18 |
| DJANGO-006 | unit         | MED        | fixed   | unit-test        | DB backend delegates to PrimaryDetector use case (Clean Architecture compliance). Architecture verified.                                                                                                                                     | `litefs_django/db/backends/litefs/base.py`                                          | 2025-12-18 |
| DJANGO-007 | unit         | EASY       | fixed   | unit-test        | Settings reader handles missing/optional fields correctly (defaults to None). Unit tests implemented.                                                                                                                                        | `litefs_django/settings.py`                                                         | 2025-12-18 |
| DJANGO-008 | differential | MED        | fixed   | unit-test        | Settings reader validation matches domain validation. Differential test implemented.                                                                                                                                                         | `litefs_django/settings.py`, `litefs/domain/settings.py`                            | 2025-12-18 |
| DJANGO-009 | unit         | MED        | fixed   | unit-test        | DB backend enforces IMMEDIATE transaction mode. Transaction mode set in get_new_connection.                                                                                                                                                  | `litefs_django/db/backends/litefs/base.py`                                          | 2025-12-18 |
| DJANGO-015 | concurrency  | MED        | fixed   | concurrency-test | Concurrent thread access to database backend is safe. Combined probabilistic concurrency test confirms multiple threads can safely perform mixed operations (reads, writes, primary checks, connection initialization) simultaneously.       | `litefs_django/db/backends/litefs/base.py`                                          | 2025-12-18 |
| DJANGO-016 | concurrency  | MED        | fixed   | concurrency-test | SQLite lock contention handled correctly with WAL mode and IMMEDIATE transactions. Probabilistic concurrency test confirms 20 concurrent threads can perform writes without "database is locked" errors.                                     | `litefs_django/db/backends/litefs/base.py:LiteFSCursor.execute`                     | 2025-12-18 |
| DJANGO-017 | concurrency  | MED        | fixed   | concurrency-test | Concurrent primary checks are thread-safe. Probabilistic concurrency test confirms PrimaryDetector.is_primary() handles concurrent calls safely during failover scenarios with no race conditions.                                           | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._check_primary_before_write` | 2025-12-18 |
| DJANGO-018 | concurrency  | MED        | fixed   | concurrency-test | Write operation detection is thread-safe. Probabilistic concurrency test confirms \_is_write_operation produces consistent results across 50 concurrent threads with no false positives or missed operations.                                | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._is_write_operation`         | 2025-12-18 |
| DJANGO-019 | concurrency  | MED        | fixed   | concurrency-test | Concurrent connection initialization is safe. Probabilistic concurrency test confirms 30 threads can initialize connections simultaneously with PRAGMA statements (WAL mode, IMMEDIATE transactions) without contention.                     | `litefs_django/db/backends/litefs/base.py:get_new_connection`                       | 2025-12-18 |
| DJANGO-014 | unit         | MED        | fixed   | unit-test        | IMMEDIATE transaction mode enforced in all transaction boundaries. Overrode `_start_transaction_under_autocommit` to execute `BEGIN IMMEDIATE` for all Django transactions (autocommit, @transaction.atomic, transaction.atomic()). | `litefs_django/db/backends/litefs/base.py:DatabaseWrapper._start_transaction_under_autocommit` | 2025-12-18 |
| DJANGO-020 | unit         | MED        | fixed   | unit-test        | Django transaction start method overridden. `_start_transaction_under_autocommit` now executes `BEGIN IMMEDIATE` instead of default `BEGIN` (DEFERRED), ensuring all transactions use IMMEDIATE mode.                               | `litefs_django/db/backends/litefs/base.py:DatabaseWrapper._start_transaction_under_autocommit` | 2025-12-18 |
| DJANGO-021 | unit         | MED        | fixed   | unit-test        | Verification added that all Django transaction boundaries use IMMEDIATE mode. Unit test verifies `BEGIN IMMEDIATE` is used in transaction start method.                                                                    | `litefs_django/db/backends/litefs/base.py`, `tests/django_adapter/unit/test_db_backend.py` | 2025-12-18 |
| DJANGO-022 | concurrency  | MED        | fixed   | concurrency-test | Connection reuse enforces IMMEDIATE mode. Concurrency test confirms that when connections are reused across transaction boundaries, all transactions use `BEGIN IMMEDIATE` mode consistently.                                    | `litefs_django/db/backends/litefs/base.py:DatabaseWrapper._start_transaction_under_autocommit` | 2025-12-18 |
| DJANGO-005 | concurrency  | MED        | fixed   | concurrency-test | DB backend connection initialization race if LiteFS not ready fixed. Added mount_path validation in get_new_connection() that raises LiteFSNotRunningError consistently. Probabilistic concurrency test confirms all threads get consistent error type. | `litefs_django/db/backends/litefs/base.py:get_new_connection`                       | 2025-12-18 |
| DJANGO-024 | concurrency  | MED        | fixed   | concurrency-test | Race condition when mount_path appears during concurrent connection attempts fixed. Added mount_path validation in get_new_connection() that handles mount_path appearance gracefully. Probabilistic concurrency test confirms no database file creation races. | `litefs_django/db/backends/litefs/base.py:get_new_connection`                       | 2025-12-18 |
| DJANGO-025 | concurrency  | MED        | fixed   | concurrency-test | Error handling for missing mount_path in get_new_connection fixed. Added mount_path validation that raises clear LiteFSNotRunningError when mount_path doesn't exist, providing graceful error handling instead of generic SQLite errors. | `litefs_django/db/backends/litefs/base.py:get_new_connection`                       | 2025-12-18 |
| DJANGO-026 | concurrency  | MED        | fixed   | concurrency-test | Error type consistency when mount_path missing fixed. Added mount_path validation in get_new_connection() that raises LiteFSNotRunningError consistently. Probabilistic concurrency test confirms all threads get same error type, making error handling predictable. | `litefs_django/db/backends/litefs/base.py:get_new_connection`                       | 2025-12-18 |
| DJANGO-027 | unit         | MED        | fixed   | unit-test        | PrimaryDetector creation validates mount_path exists (fail-fast) fixed. Added mount_path validation in __init__() that raises LiteFSNotRunningError immediately when mount_path doesn't exist, ensuring fail-fast behavior before PrimaryDetector creation. | `litefs_django/db/backends/litefs/base.py:DatabaseWrapper.__init__`                | 2025-12-18 |
| DJANGO-003 | concurrency  | HARD       | wontfix | hex-analysis     | DB backend race condition: Primary check → write operation gap (primary could change between check and write, allowing writes on replica). This is an architectural limitation of LiteFS's single-writer model. Documented in code comments. | `litefs_django/db/backends/litefs/base.py`                                          | 2025-12-18 |
| CORE-001   | property     | MED        | fixed   | property-test    | Config generation round-trip idempotence verified. Property-based test implemented confirming parse(generate(settings)) preserves all YAML-representable fields.                                                                  | `litefs/usecases/config_generator.py`, `litefs/usecases/config_parser.py`          | 2025-12-18 |
| CORE-011   | unit         | MED        | fixed   | unit-test        | Config generation includes `proxy.addr` field in YAML. Unit tests verify proxy_addr setting is preserved in generated config.                                                                                                    | `litefs/usecases/config_generator.py`                                               | 2025-12-18 |
| CORE-012   | unit         | MED        | fixed   | unit-test        | ConfigParser use case implemented to convert LiteFS YAML config back to LiteFSSettings. Round-trip functionality enabled with proper error handling.                                                                            | `litefs/usecases/config_parser.py`                                                  | 2025-12-18 |
| CORE-002   | concurrency  | MED        | fixed   | concurrency-test | Primary detection two-step check race condition does not exist. Probabilistic concurrency test confirms that if mount_path disappears between checks, `primary_file.exists()` returns False (no exception), maintaining consistent behavior. | `litefs/usecases/primary_detector.py:is_primary()`                 | 2025-12-18 |
| CORE-013   | concurrency  | MED        | fixed   | concurrency-test | Symlink staleness issue does not exist. Probabilistic concurrency test confirms Path operations resolve symlinks automatically on each call, so detector correctly uses updated symlink targets without caching stale paths.        | `litefs/usecases/primary_detector.py:__init__()`                   | 2025-12-18 |
| CORE-014   | concurrency  | MED        | fixed   | concurrency-test | Exception type consistency verified. Probabilistic concurrency test confirms all exceptions during concurrent mount_path deletion are consistently LiteFSNotRunningError (no OSError or other types), regardless of deletion timing. | `litefs/usecases/primary_detector.py:is_primary()`                 | 2025-12-18 |
| CORE-005   | concurrency  | MED        | wontfix | arch-analysis    | TOCTOU: `is_primary()` result may be stale by caller action time. Architectural limitation - callers must handle ReplicaWriteError. Basic file race covered by CORE-002.                                                        | `packages/litefs/src/litefs/usecases/primary_detector.py:is_primary` | 2025-12-18 |
| CORE-008   | concurrency  | MED        | wontfix | arch-analysis    | Duplicate of CORE-002. Primary detection concurrent writes to `.primary` already tested and verified safe via `file.exists()` atomicity.                                                                                         | `packages/litefs/src/litefs/usecases/primary_detector.py`            | 2025-12-18 |
| CORE-003-PBT | property   | EASY       | fixed  | property-test    | Path sanitization PBT implemented. Null byte injection bug found and fixed - validation now rejects paths containing null bytes. Unicode paths validated correctly.                                                                 | `packages/litefs/src/litefs/domain/settings.py:_validate_paths`      | 2025-12-18 |
| CORE-004   | property     | MED        | fixed  | property-test    | YAML generation PBT implemented. Verified that `yaml.dump()` handles all edge cases correctly (special chars, multi-line, empty strings, unicode) - no bugs found.                                                              | `packages/litefs/src/litefs/usecases/config_generator.py:generate`   | 2025-12-18 |
| CORE-006   | unit         | EASY       | wontfix | arch-analysis    | No normalization methods exist in `LiteFSSettings` - nothing to test. Settings is a dataclass with no normalization logic.                                                                                                        | `packages/litefs/src/litefs/domain/settings.py`                      | 2025-12-18 |
| CORE-007   | unit         | MED        | wontfix | arch-analysis    | `ConfigGenerator.generate()` takes validated `LiteFSSettings` instance - cannot have missing required fields. Input validation ensures all fields present.                                                                      | `packages/litefs/src/litefs/usecases/config_generator.py`           | 2025-12-18 |
| CORE-009   | unit         | EASY       | wontfix | arch-analysis    | `proxy_addr` is a socket address string format (`:8080`, `localhost:3000`), not a port number. No port validation needed - format validation handled by LiteFS itself.                                                           | `packages/litefs/src/litefs/domain/settings.py`                     | 2025-12-18 |
| CORE-010   | unit         | MED        | fixed  | unit-test        | Config output determinism verified. Test confirms same settings produce byte-identical YAML output. Python 3.7+ dict ordering ensures deterministic output.                                                                     | `packages/litefs/src/litefs/usecases/config_generator.py:generate`   | 2025-12-18 |
| INTEG-001  | unit         | MED        | fixed   | unit-test        | `litefs_available` fixture now uses `subprocess.run()` instead of `os.system()` for thread-safe Docker detection. Prevents flaky detection in parallel test collection (pytest-xdist).                                                                           | `tests/django_adapter/integration/conftest.py:litefs_available`            | 2025-12-18 |
| INTEG-002  | unit         | MED        | fixed   | unit-test        | FUSE detection now supports cross-platform paths. macOS checks `/dev/osxfuse` and `/dev/macfuse`. Linux checks `/dev/fuse`. Non-POSIX fallback returns True. Helper function `_check_fuse_available()` extracted for clarity.                                                 | `tests/django_adapter/integration/conftest.py:_check_fuse_available`            | 2025-12-18 |
| INTEG-004  | unit         | EASY       | fixed   | unit-test        | Double-skip pattern removed. Integration tests no longer call `pytest.skip()` internally. Tests rely solely on `skip_if_no_litefs` fixture for skipping when infrastructure unavailable.                                                                         | `tests/django_adapter/integration/test_db_backend_integration.py`          | 2025-12-18 |
| INTEG-003  | unit         | HARD       | wontfix | hex-analysis     | No multi-node cluster integration tests. Placeholder tests only verify single-node scenarios. Actual replication, failover, and split-brain scenarios require 2+ node Docker Compose setup. Out of scope - requires Docker Compose infrastructure setup.                                      | `tests/django_adapter/integration/test_db_backend_integration.py`          | 2025-12-18 |
| DJANGO-013 | concurrency  | MED        | fixed   | concurrency-test | WAL mode setting contention tested. DJANGO-019 confirms 30 concurrent threads can initialize connections with PRAGMA journal_mode=WAL without contention.                                                                       | `litefs_django/db/backends/litefs/base.py:get_new_connection`      | 2025-12-18 |
| DJANGO-004 | concurrency  | MED        | fixed   | concurrency-test | TOCTOU gap behavior documented and tested. Test verifies behavior when failover occurs between is_primary() check and execute(). Related to DJANGO-003 (wontfix architectural limit).                                           | `litefs_django/db/backends/litefs/base.py:LiteFSCursor.execute`    | 2025-12-18 |
| DJANGO-023 | concurrency  | MED        | fixed   | concurrency-test | Error type tests implemented. Documents sqlite3.OperationalError propagation when TOCTOU gap allows write to reach SQLite on replica.                                                                                           | `litefs_django/db/backends/litefs/base.py:LiteFSCursor.execute`    | 2025-12-18 |
| DJANGO-012 | concurrency  | MED        | fixed   | concurrency-test | Shared PrimaryDetector instance across threads tested. Concurrent is_primary() calls during failover work correctly - file.exists() is atomic. No race condition found.                                                         | `litefs_django/db/backends/litefs/base.py`, `litefs/usecases/primary_detector.py` | 2025-12-18 |
| DJANGO-010 | unit         | MED        | fixed   | unit-test        | Write detection now handles CTE patterns, maintenance operations (VACUUM/REINDEX/ANALYZE), and SQL with leading comments. Enhanced `_is_write_operation()` with comment stripping and CTE keyword detection.                    | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._is_write_operation`       | 2025-12-18 |
| DJANGO-028 | unit         | MED        | fixed   | unit-test        | `executescript()` now overridden to check primary status before execution. Scripts may contain write operations, so primary check is mandatory. Raises NotPrimaryError on replica nodes.                                         | `litefs_django/db/backends/litefs/base.py:LiteFSCursor.executescript`             | 2025-12-18 |
| DJANGO-029 | unit         | MED        | fixed   | unit-test        | CTE (Common Table Expression) write patterns now detected. `WITH ... INSERT/UPDATE/DELETE` statements correctly identified as write operations via keyword scanning after WITH clause.                                           | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._is_write_operation`       | 2025-12-18 |
| DJANGO-030 | unit         | MED        | fixed   | unit-test        | Database maintenance operations (VACUUM, REINDEX, ANALYZE) now detected as write operations. These modify database state and require primary node access.                                                                        | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._is_write_operation`       | 2025-12-18 |
| DJANGO-031 | unit         | MED        | fixed   | unit-test        | SQL comment stripping implemented for write detection. Block comments (`/* ... */`) and line comments (`-- ...`) are removed before keyword detection, preventing bypass via comment-prefixed statements.                        | `litefs_django/db/backends/litefs/base.py:LiteFSCursor._strip_sql_comments`       | 2025-12-18 |
| DJANGO-032 | unit         | MED        | wontfix | unit-test        | PrimaryDetector lifecycle confirmed safe. Detector instance shared across cursor operations remains valid - Path.exists() is atomic and stateless. No stale state issues found.                                                  | `litefs_django/db/backends/litefs/base.py:LiteFSCursor`                           | 2025-12-18 |
| PERF-001   | unit         | EASY       | fixed   | unit-test        | Regex compilation in hot path fixed. `_strip_sql_comments()` now uses pre-compiled regex patterns `_BLOCK_COMMENT_RE` and `_LINE_COMMENT_RE` at module level instead of `re.sub()` compiling on every call.                      | `litefs_django/db/backends/litefs/base.py:_strip_sql_comments`                    | 2025-12-19 |
| DJANGO-033 | unit         | EASY       | wontfix | hex-analysis     | Cursor lifecycle in `_start_transaction_under_autocommit()` is managed by Django's connection pooling. No explicit close needed - Django manages cursor lifecycle through connection management.                                   | `litefs_django/db/backends/litefs/base.py:_start_transaction_under_autocommit`    | 2025-12-19 |
| DJANGO-034 | unit         | MED        | fixed   | unit-test        | Module re-import fixed. `import re` moved from inside `_strip_sql_comments()` method body to module level for proper Python import pattern.                                                                                        | `litefs_django/db/backends/litefs/base.py:_strip_sql_comments`                    | 2025-12-19 |
| CORE-015   | property     | MED        | wontfix | hex-analysis     | ConfigParser/ConfigGenerator asymmetry is intentional design. `enabled`/`retention` are Python-only fields not part of LiteFS YAML spec. Round-trip only preserves YAML-representable fields by design.                          | `litefs/usecases/config_parser.py:parse`, `litefs/usecases/config_generator.py`   | 2025-12-19 |
| CONC-001   | concurrency  | HARD       | wontfix | hex-analysis     | Duplicate of DJANGO-033. Cursor lifecycle in `_start_transaction_under_autocommit()` is managed by Django's connection pooling. No explicit close needed.                                                                         | `litefs_django/db/backends/litefs/base.py:272`                                    | 2025-12-19 |
| CONC-003   | concurrency  | MED        | wontfix | hex-analysis     | Duplicate of DJANGO-005, DJANGO-024, DJANGO-025, DJANGO-026. Path.exists() atomicity already tested extensively. Returns False on missing path without exception.                                                                  | `litefs_django/db/backends/litefs/base.py:240`                                    | 2025-12-19 |
| CORE-016   | property     | MED        | wontfix | hex-analysis     | Python strings are immutable. Cannot be mutated after construction. PrimaryDetector path is created from immutable string in __init__, so stale path is impossible.                                                               | `litefs/usecases/primary_detector.py:23-24`                                       | 2025-12-19 |
| CONC-002   | unit         | MED        | fixed   | unit-test        | CTE detection false positives fixed. Now uses word boundary regex `\b(INSERT|UPDATE|DELETE)\b` instead of substring match. Column/table names like `delete_flag`, `update_count`, `insert_date`, `deleted_items` no longer trigger false positives. | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| CONC-004   | concurrency  | MED        | wontfix | hex-analysis     | Duplicate of DJANGO-033. Cursor lifecycle in `_start_transaction_under_autocommit()` is managed by Django's connection pooling. No explicit close needed.                                                                         | `litefs_django/db/backends/litefs/base.py:_start_transaction_under_autocommit`    | 2025-12-19 |
| SQL-001    | unit         | EASY       | fixed   | unit-test        | `_is_write_operation` now detects `ATTACH DATABASE` and `DETACH DATABASE` statements. Added `ATTACH` and `DETACH` to write_keywords tuple to prevent replica nodes from attaching writeable databases.                             | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-002    | unit         | EASY       | fixed   | unit-test        | `_is_write_operation` now detects SQLite `SAVEPOINT`, `RELEASE SAVEPOINT`, and `ROLLBACK TO SAVEPOINT` commands. Added `SAVEPOINT`, `RELEASE`, and `ROLLBACK` to write_keywords tuple.                                             | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-003    | unit         | EASY       | fixed   | unit-test        | `_is_write_operation` now detects state-modifying `PRAGMA` statements (e.g., `PRAGMA user_version=N`). Only PRAGMAs with `=` assignment are detected as writes; read-only PRAGMAs (no `=`) return False.                           | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-004    | unit         | EASY       | wontfix | hex-analysis     | Not a bug. `INSERT...ON CONFLICT DO UPDATE` detected correctly because INSERT prefix is matched first. All INSERT variants (ON CONFLICT, OR REPLACE, OR IGNORE) are detected as writes.                                            | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-005    | unit         | EASY       | wontfix | hex-analysis     | Not a bug. SQLite UPSERT (INSERT...ON CONFLICT) detected correctly because INSERT prefix is matched first. All INSERT variants are detected as writes regardless of ON CONFLICT clause.                                            | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| CONC-005   | concurrency  | MED        | wontfix | hex-analysis     | Duplicate of DJANGO-033, CONC-001, CONC-004. Cursor lifecycle in `_start_transaction_under_autocommit()` managed by Django's connection pooling. Django's own implementation has identical pattern.                                  | `litefs_django/db/backends/litefs/base.py:293`                                    | 2025-12-19 |
| PROP-001   | unit         | MED        | wontfix | unit-test        | Not a bug. Unknown Django settings keys are silently ignored by design. This follows Django convention where settings dicts often contain extra keys from other apps. Test confirms intended behavior.                               | `litefs_django/settings.py:get_litefs_settings`                                   | 2025-12-19 |
| PROP-002   | unit         | MED        | fixed   | unit-test        | Required field validation now implemented in `get_litefs_settings()`. Missing required fields now raise `LiteFSConfigError` with helpful message listing all missing field names instead of unclear `TypeError`.                     | `litefs_django/settings.py:get_litefs_settings`                                   | 2025-12-19 |
| ARCH-001   | fake-adapter | MED        | fixed   | unit-test        | FakePrimaryDetector implemented with contract tests. Provides in-memory adapter for unit tests without filesystem I/O. Fixture `fake_primary_detector` now available in `tests/django_adapter/unit/conftest.py`.                     | `tests/django_adapter/unit/fakes.py`, `tests/django_adapter/unit/conftest.py`     | 2025-12-19 |
| SQL-007    | unit         | EASY       | wontfix | unit-test        | Not a bug. WITH RECURSIVE CTE patterns correctly handled by word-boundary regex `\b(INSERT\|UPDATE\|DELETE)\b`. RECURSIVE keyword doesn't interfere. Tests added to confirm correct behavior.                                         | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-008    | unit         | MED        | wontfix | hex-analysis     | Not a bug. `CREATE TRIGGER` already detected via `CREATE` keyword prefix match. Trigger body scanning unnecessary - schema change requires primary regardless of body content.                                                          | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-009    | unit         | MED        | wontfix | hex-analysis     | Not a bug. `CREATE VIEW` already detected via `CREATE` keyword prefix match. INSTEAD OF trigger analysis unnecessary - schema change requires primary regardless of trigger semantics.                                                  | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| SQL-010    | unit         | EASY       | wontfix | hex-analysis     | Not a bug. `DROP TRIGGER` and `DROP VIEW` already detected via `DROP` keyword prefix match. All DROP variants (TABLE, INDEX, TRIGGER, VIEW) are caught by `startswith("DROP")`.                                                        | `litefs_django/db/backends/litefs/base.py:_is_write_operation`                    | 2025-12-19 |
| CONC-006   | concurrency  | MED        | wontfix | hex-analysis     | Intentional design. `executescript` requires primary for ALL scripts (conservative approach). Scripts may contain writes, so requiring primary is correct behavior. Per-statement analysis would be complex and error-prone.            | `litefs_django/db/backends/litefs/base.py:LiteFSCursor.executescript`             | 2025-12-19 |
| PARSE-002  | unit         | EASY       | wontfix | hex-analysis     | Acceptable behavior. Empty `databases` list raises IndexError which is caught and converted to LiteFSConfigError with message "list index out of range". Error type is correct; message clarity is acceptable.                          | `litefs/usecases/config_parser.py:parse:39`                                       | 2025-12-19 |
| PARSE-001  | unit         | MED        | fixed   | unit-test        | `ConfigParser.parse()` now validates `databases[0].path` is non-empty. Empty or whitespace-only strings raise LiteFSConfigError("database path cannot be empty").                                                                        | `litefs/usecases/config_parser.py:parse`                                          | 2025-12-19 |
| RAFT-001   | fake-adapter | MED        | fixed   | arch-analysis    | `PrimaryDetectorPort` Protocol defined in `litefs.adapters.ports`. `FakePrimaryDetector` signature updated to accept optional `mount_path` for compatibility with real detector. Both implement Protocol correctly.                        | `packages/litefs/src/litefs/adapters/ports.py`, `tests/django_adapter/unit/fakes.py` | 2025-12-20 |
| RAFT-002   | fake-adapter | MED        | fixed   | arch-analysis    | `DatabaseWrapper.__init__` now accepts optional `primary_detector: PrimaryDetectorPort` parameter for dependency injection. Enables pure unit tests with `FakePrimaryDetector` without monkey-patching.                                   | `packages/litefs-django/src/litefs_django/db/backends/litefs/base.py`             | 2025-12-20 |
| RAFT-003   | parallel-isolation | MED  | fixed   | arch-analysis    | Concurrency tests marked with `@pytest.mark.no_parallel` to prevent parallel execution failures. Marker registered in `pytest.ini` for both core and django adapter packages.                                                             | `tests/core/unit/usecases/test_primary_detector.py`, `tests/django_adapter/unit/test_db_backend_concurrency.py` | 2025-12-20 |
| RAFT-004   | parallel-isolation | MED  | fixed   | arch-analysis    | Django settings singleton issue addressed by `@pytest.mark.no_parallel` marker. Tests that require Django setup cannot run in parallel with pytest-xdist.                                                                                  | `tests/django_adapter/unit/test_db_backend_concurrency.py`                        | 2025-12-20 |
| RAFT-005   | property     | MED        | fixed   | arch-analysis    | PBT tests verify `_strip_sql_comments()` idempotence (strip(strip(x)) == strip(x)), block comment removal, and line comment removal. 13 property tests added in `test_sql_properties.py`.                                                  | `tests/django_adapter/unit/test_sql_properties.py`                                | 2025-12-20 |
| RAFT-006   | property     | MED        | fixed   | arch-analysis    | PBT tests verify `_is_write_operation()` case insensitivity, empty input handling, CTE word boundary detection (no false positives on column names like `delete_flag`), and comment handling. 13 property tests in `test_sql_properties.py`. | `tests/django_adapter/unit/test_sql_properties.py`                                | 2025-12-20 |
| RAFT-007   | unit         | EASY       | fixed   | arch-analysis    | `LiteFSCursor.__init__` now has type hint `primary_detector: PrimaryDetectorPort` for clear ownership semantics. Type hints verified via unit tests checking `__annotations__`.                                                            | `packages/litefs-django/src/litefs_django/db/backends/litefs/base.py:34`          | 2025-12-20 |
